import { ValueChangeNotification } from "./value-change-notification";
const FILTER = "filter";
const FUNCTION = "function";
const ERRORS = "errors";
export class PropDescriptor extends ValueChangeNotification {
    checkFilterFunction() {
        let descriptor = Object.getOwnPropertyDescriptor(Object.getPrototypeOf(this), FILTER);
        this.isDefinedFilter = (descriptor && !descriptor.get && !descriptor.set && typeof this[FILTER] == FUNCTION);
    }
    overrideProp(props) {
        Object.keys(props).forEach(t => {
            Object.defineProperty(this, t, props[t]);
        });
    }
    defineProp(propName) {
        let value = this.props[propName];
        let oldValue = null;
        Object.defineProperty(this.props, propName, {
            get: () => { return value; },
            set: (v) => {
                value = v;
                this.notifyValueChanged(`props.${propName}`, value, oldValue, false);
                oldValue = value;
            }
        });
    }
    overrideProps() {
        ["disabled", "label", "placeholder", "hide", "description", "focus", "readonly", "class", "source"].forEach(t => {
            let descriptor = this.getDescriptor(t);
            let value = null;
            let oldValue = null;
            Object.defineProperty(this, t, {
                get: () => { return descriptor ? descriptor.get.call(this) : value; },
                set: (v) => {
                    value = v;
                    if (descriptor && descriptor.set)
                        descriptor.set.call(this, v);
                    super.notifyValueChanged(t, value, oldValue);
                    oldValue = v;
                }
            });
        });
    }
    overrideErrorsProp(formControl) {
        let value = formControl.errors;
        let errorMessage = '';
        let oldValue = formControl.errorMessage;
        Object.defineProperty(formControl, ERRORS, {
            get: () => { return value; },
            set: (v) => {
                value = v;
                errorMessage = formControl.errorMessage;
                this.notifyValueChanged(`errorMessage`, errorMessage || "", oldValue);
                oldValue = formControl.errorMessage;
            }
        });
        formControl[ERRORS] = formControl[ERRORS];
    }
    getDescriptor(propName) {
        let descriptor = Object.getOwnPropertyDescriptor(Object.getPrototypeOf(this), propName);
        if (!descriptor)
            descriptor = Object.getOwnPropertyDescriptor(this, propName);
        return descriptor;
    }
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicHJvcC1kZXNjcmlwdG9yLmpzIiwic291cmNlUm9vdCI6Im5nOi8vQHJ4d2ViL3JlYWN0aXZlLWR5bmFtaWMtZm9ybXMvIiwic291cmNlcyI6WyJzZXJ2aWNlcy9wcm9wLWRlc2NyaXB0b3IudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsT0FBTyxFQUFFLHVCQUF1QixFQUFFLE1BQU0sNkJBQTZCLENBQUM7QUFHdEUsTUFBTSxNQUFNLEdBQVcsUUFBUSxDQUFDO0FBQ2hDLE1BQU0sUUFBUSxHQUFXLFVBQVUsQ0FBQztBQUNwQyxNQUFNLE1BQU0sR0FBVyxRQUFRLENBQUM7QUFDaEMsTUFBTSxPQUFPLGNBQWUsU0FBUSx1QkFBdUI7SUFLN0MsbUJBQW1CO1FBQ3pCLElBQUksVUFBVSxHQUFHLE1BQU0sQ0FBQyx3QkFBd0IsQ0FBQyxNQUFNLENBQUMsY0FBYyxDQUFDLElBQUksQ0FBQyxFQUFFLE1BQU0sQ0FBQyxDQUFDO1FBQ3RGLElBQUksQ0FBQyxlQUFlLEdBQUcsQ0FBQyxVQUFVLElBQUksQ0FBQyxVQUFVLENBQUMsR0FBRyxJQUFJLENBQUMsVUFBVSxDQUFDLEdBQUcsSUFBSSxPQUFPLElBQUksQ0FBQyxNQUFNLENBQUMsSUFBSSxRQUFRLENBQUMsQ0FBQztJQUNqSCxDQUFDO0lBR0QsWUFBWSxDQUFDLEtBQXdCO1FBQ2pDLE1BQU0sQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQSxFQUFFO1lBQzFCLE1BQU0sQ0FBQyxjQUFjLENBQUMsSUFBSSxFQUFDLENBQUMsRUFBQyxLQUFLLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQztRQUMzQyxDQUFDLENBQUMsQ0FBQTtJQUVOLENBQUM7SUFFRCxVQUFVLENBQUMsUUFBZ0I7UUFDdkIsSUFBSSxLQUFLLEdBQUcsSUFBSSxDQUFDLEtBQUssQ0FBQyxRQUFRLENBQUMsQ0FBQztRQUNqQyxJQUFJLFFBQVEsR0FBRyxJQUFJLENBQUM7UUFDcEIsTUFBTSxDQUFDLGNB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QUFDO0lBQzFCLENBQUM7Q0FJSiIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IFZhbHVlQ2hhbmdlTm90aWZpY2F0aW9uIH0gZnJvbSBcIi4vdmFsdWUtY2hhbmdlLW5vdGlmaWNhdGlvblwiO1xyXG5pbXBvcnQgeyBPdmVycmlkZUNvbmZpZ1Byb3AgfSBmcm9tIFwiLi4vbW9kZWxzL2ludGVyZmFjZS9vdmVycmlkZS1jb25maWctcHJvcFwiO1xyXG5cclxuY29uc3QgRklMVEVSOiBzdHJpbmcgPSBcImZpbHRlclwiO1xyXG5jb25zdCBGVU5DVElPTjogc3RyaW5nID0gXCJmdW5jdGlvblwiO1xyXG5jb25zdCBFUlJPUlM6IHN0cmluZyA9IFwiZXJyb3JzXCI7XHJcbmV4cG9ydCBjbGFzcyBQcm9wRGVzY3JpcHRvciBleHRlbmRzIFZhbHVlQ2hhbmdlTm90aWZpY2F0aW9ue1xyXG4gICAgcHJvdGVjdGVkIGlzRGVmaW5lZEZpbHRlcjogYm9vbGVhbjtcclxuXHJcbiAgICBwcm9wczogeyBba2V5OiBzdHJpbmddOiBhbnkgfTtcclxuXHJcbiAgICBwcm90ZWN0ZWQgY2hlY2tGaWx0ZXJGdW5jdGlvbigpIHtcclxuICAgICAgICBsZXQgZGVzY3JpcHRvciA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IoT2JqZWN0LmdldFByb3RvdHlwZU9mKHRoaXMpLCBGSUxURVIpO1xyXG4gICAgICAgIHRoaXMuaXNEZWZpbmVkRmlsdGVyID0gKGRlc2NyaXB0b3IgJiYgIWRlc2NyaXB0b3IuZ2V0ICYmICFkZXNjcmlwdG9yLnNldCAmJiB0eXBlb2YgdGhpc1tGSUxURVJdID09IEZVTkNUSU9OKTtcclxuICAgIH1cclxuXHJcbiAgIFxyXG4gICAgb3ZlcnJpZGVQcm9wKHByb3BzOk92ZXJyaWRlQ29uZmlnUHJvcCl7XHJcbiAgICAgICAgT2JqZWN0LmtleXMocHJvcHMpLmZvckVhY2godD0+e1xyXG4gICAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcyx0LHByb3BzW3RdKTsgICAgXHJcbiAgICAgICAgfSlcclxuXHJcbiAgICB9XHJcblxyXG4gICAgZGVmaW5lUHJvcChwcm9wTmFtZTogc3RyaW5nKSB7XHJcbiAgICAgICAgbGV0IHZhbHVlID0gdGhpcy5wcm9wc1twcm9wTmFtZV07XHJcbiAgICAgICAgbGV0IG9sZFZhbHVlID0gbnVsbDtcclxuICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcy5wcm9wcywgcHJvcE5hbWUsXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIGdldDogKCkgPT4geyByZXR1cm4gdmFsdWUgfSxcclxuICAgICAgICAgICAgICAgIHNldDogKHYpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICB2YWx1ZSA9IHY7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5ub3RpZnlWYWx1ZUNoYW5nZWQoYHByb3BzLiR7cHJvcE5hbWV9YCwgdmFsdWUsIG9sZFZhbHVlLCBmYWxzZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgb2xkVmFsdWUgPSB2YWx1ZTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSlcclxuICAgIH1cclxuXHJcblxyXG4gICAgcHJvdGVjdGVkIG92ZXJyaWRlUHJvcHMoKSB7XHJcbiAgICAgICAgW1wiZGlzYWJsZWRcIiwgXCJsYWJlbFwiLCBcInBsYWNlaG9sZGVyXCIsIFwiaGlkZVwiLCBcImRlc2NyaXB0aW9uXCIsIFwiZm9jdXNcIiwgXCJyZWFkb25seVwiLCBcImNsYXNzXCIsIFwic291cmNlXCJdLmZvckVhY2godCA9PiB7XHJcbiAgICAgICAgICAgbGV0IGRlc2NyaXB0b3IgPSB0aGlzLmdldERlc2NyaXB0b3IodCk7XHJcbiAgICAgICAgICAgIGxldCB2YWx1ZSA9IG51bGw7XHJcbiAgICAgICAgICAgIGxldCBvbGRWYWx1ZSA9IG51bGw7XHJcbiAgICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCB0LCB7XHJcbiAgICAgICAgICAgICAgICBnZXQ6ICgpID0+IHsgcmV0dXJuIGRlc2NyaXB0b3IgPyBkZXNjcmlwdG9yLmdldC5jYWxsKHRoaXMpIDogdmFsdWU7IH0sXHJcbiAgICAgICAgICAgICAgICBzZXQ6ICh2KSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFsdWUgPSB2O1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChkZXNjcmlwdG9yICYmIGRlc2NyaXB0b3Iuc2V0KVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdG9yLnNldC5jYWxsKHRoaXMsIHYpO1xyXG4gICAgICAgICAgICAgICAgICAgIHN1cGVyLm5vdGlmeVZhbHVlQ2hhbmdlZCh0LCB2YWx1ZSwgb2xkVmFsdWUpO1xyXG4gICAgICAgICAgICAgICAgICAgIG9sZFZhbHVlID0gdjtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSlcclxuICAgIH1cclxuXHJcblxyXG4gICAgcHJvdGVjdGVkIG92ZXJyaWRlRXJyb3JzUHJvcChmb3JtQ29udHJvbDogYW55KSB7XHJcbiAgICAgICAgbGV0IHZhbHVlID0gZm9ybUNvbnRyb2wuZXJyb3JzO1xyXG4gICAgICAgIGxldCBlcnJvck1lc3NhZ2UgPSAnJztcclxuICAgICAgICBsZXQgb2xkVmFsdWUgPSBmb3JtQ29udHJvbC5lcnJvck1lc3NhZ2U7XHJcbiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KGZvcm1Db250cm9sLCBFUlJPUlMsXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIGdldDogKCkgPT4geyByZXR1cm4gdmFsdWUgfSxcclxuICAgICAgICAgICAgICAgIHNldDogKHYpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICB2YWx1ZSA9IHY7XHJcbiAgICAgICAgICAgICAgICAgICAgZXJyb3JNZXNzYWdlID0gZm9ybUNvbnRyb2wuZXJyb3JNZXNzYWdlO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMubm90aWZ5VmFsdWVDaGFuZ2VkKGBlcnJvck1lc3NhZ2VgLCBlcnJvck1lc3NhZ2UgfHwgXCJcIiwgb2xkVmFsdWUpO1xyXG4gICAgICAgICAgICAgICAgICAgIG9sZFZhbHVlID0gZm9ybUNvbnRyb2wuZXJyb3JNZXNzYWdlO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgIGZvcm1Db250cm9sW0VSUk9SU10gPSBmb3JtQ29udHJvbFtFUlJPUlNdO1xyXG4gICAgfVxyXG5cclxuICAgIHByb3RlY3RlZCBnZXREZXNjcmlwdG9yKHByb3BOYW1lOnN0cmluZyl7XHJcblxyXG4gICAgICAgIGxldCBkZXNjcmlwdG9yID0gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihPYmplY3QuZ2V0UHJvdG90eXBlT2YodGhpcyksIHByb3BOYW1lKTtcclxuICAgICAgICBpZighZGVzY3JpcHRvcilcclxuICAgICAgICAgICAgZGVzY3JpcHRvciA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IodGhpcywgcHJvcE5hbWUpO1xyXG4gICAgICAgICAgICByZXR1cm4gZGVzY3JpcHRvcjtcclxuICAgIH1cclxuXHJcblxyXG5cclxufSJdfQ==